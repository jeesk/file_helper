{"version":3,"sources":["render.js"],"names":["TipsType","tipsNormal","tipsPrimary","tipsSuccess","tipsInfo","tipsWarning","tipsDanger","TitleType","admin","owner","beforeRenderingHTML","data","chatboxClass","length","htmlStr","chatBox","document","querySelector","i","isRender","messageType","indexOf","renderTipHtml","html","renderMessageHtml","insertAdjacentHTML","setTimeout","scrollHeight","clientHeight","scrollTop","localStorage","setItem","JSON","stringify","concat","position","diamond","headIcon","renderTitleHtml","htitle","htitleType","escapeHtml","name","handleDoubleClick","element","navigator","clipboard","writeText","innerText","content","css","unsafe","replace","c","charCodeAt","slice","addEventListener","event","target","matches"],"mappings":";;;;GAAA,aAAA,IAAMA,SAAW,CACbC,WAAY,OACZC,YAAa,eACbC,YAAa,eACbC,SAAU,YACVC,YAAa,eACbC,WAAY,eAEVC,UAAY,CACdC,MAAO,QACPC,MAAO,SAGX,SAASC,oBAAoBC,EAAMC,GAC/B,GAAmB,GAAfD,EAAKE,OAAT,CAKA,IAFA,IAAIC,EAAU,GACVC,EAAUC,SAASC,cAAcL,GAC5BM,EAAI,EAAGA,EAAIP,EAAKE,OAAQK,IACzBP,EAAKO,GAAGC,YAGiC,IAAzCR,EAAKO,GAAGE,YAAYC,QAAQ,QAC5BP,GAAWQ,cAAcX,EAAKO,GAAGK,KAAMvB,SAASW,EAAKO,GAAGE,cAAgB,QAExEN,GAAWU,kBAAkBb,EAAKO,IAEtCP,EAAKO,GAAGC,UAAW,GAGvBJ,EAAQU,mBAAmB,YAAaX,GACxCY,YAAW,WACHX,EAAQY,aAAeZ,EAAQa,eAC/Bb,EAAQc,UAAYd,EAAQY,aAC5BZ,EAAU,GACVD,EAAU,GAElB,GAAG,KACHgB,aAAaC,QAAQ,QAASC,KAAKC,UAAUtB,GAvB7C,CAwBJ,CAEA,SAASa,kBAAkBb,GACvB,MAAA,gBAAAuB,OAAuBvB,EAAKwB,SAAQ,0CAAAD,OACTvB,EAAKyB,QAAU,GAAK,SAAQ,WAAAF,OAAUvB,EAAK0B,SAAQ,4GAAAH,OAEpEI,gBAAgB3B,EAAK4B,OAAQhC,UAAUI,EAAK6B,aAAe,IAAG,wBAAAN,OACxDO,WAAW9B,EAAK+B,OAAS,SAAQ,uEAAAR,OAEW,QAArBvB,EAAKS,YAAwBT,EAAKY,KAAOkB,WAAW9B,EAAKY,MAAK,sBAEzG,CAUA,SAASoB,kBAAkBC,GACvBC,UAAUC,UAAUC,UAAUH,EAAQI,UAC1C,CAGA,SAASV,gBAAgBW,EAASC,GAC9B,OAAKD,EACL,uBAAAf,OAA8BgB,EAAG,iCAAAhB,OAAgCe,EAAO,WADnD,EAEzB,CAEA,SAAS3B,cAAc2B,EAASC,GAC5B,OAAKD,EACL,kCAAAf,OAAyCgB,EAAG,mCAAAhB,OAAkCO,WAAWQ,GAAQ,iBAD5E,EAEzB,CAIA,SAASR,WAAWU,GAChB,OAAOA,aAAM,EAANA,EAAQC,QACX,2DACA,SAAAC,GAAC,MAAI,MAAQ,MAAQA,EAAEC,WAAW,IAAIC,OAAO,GAAK,GAAG,GAE7D,CA7BAvC,SAASwC,iBAAiB,YAAY,SAASC,GAC3C,IAAMC,EAASD,EAAMC,OACjBA,EAAOC,QAAQ,aACfhB,kBAAkBe,EAE1B","file":"../litewebchat_render.min.js","sourcesContent":["const TipsType = {\n    tipsNormal: 'tips',\n    tipsPrimary: 'tips-primary',\n    tipsSuccess: 'tips-success',\n    tipsInfo: 'tips-info',\n    tipsWarning: 'tips-warning',\n    tipsDanger: 'tips-danger',\n};\nconst TitleType = {\n    admin: 'admin',\n    owner: 'owner',\n};\n\nfunction beforeRenderingHTML(data, chatboxClass) {\n    if (data.length == 0) {\n        return\n    }\n    let htmlStr = '';\n    let chatBox = document.querySelector(chatboxClass);\n    for (let i = 0; i < data.length; i++) {\n        if (data[i].isRender) {\n            continue;\n        }\n        if (data[i].messageType.indexOf('tips') !== -1) {\n            htmlStr += renderTipHtml(data[i].html, TipsType[data[i].messageType] || 'tips');\n        } else {\n            htmlStr += renderMessageHtml(data[i]);\n        }\n        data[i].isRender = true;\n    }\n\n    chatBox.insertAdjacentHTML('beforeend', htmlStr);\n    setTimeout(() => {\n        if (chatBox.scrollHeight > chatBox.clientHeight) {\n            chatBox.scrollTop = chatBox.scrollHeight;\n            chatBox = '';\n            htmlStr = '';\n        }\n    }, 300);\n    localStorage.setItem(\"htmls\", JSON.stringify(data))\n}\n\nfunction renderMessageHtml(data) {\n    return `<div class=\"c${data.position} cmsg\">\n        <img class=\"headIcon ${data.diamond ? '' : 'radius'}\" src=\"${data.headIcon}\" ondragstart=\"return false;\" oncontextmenu=\"return false;\"/>\n        <span class=\"name\">\n            ${renderTitleHtml(data.htitle, TitleType[data.htitleType] || '')}\n            <span>${escapeHtml(data.name) || '&nbsp;'}</span>\n        </span>\n        <span id=\"span_\" class=\"content\">${data.messageType === 'raw' ? data.html : escapeHtml(data.html)}</span>\n    </div>`;\n}\n\n// 事件委托，给父元素添加双击事件监听器\ndocument.addEventListener('dblclick', function(event) {\n    const target = event.target;\n    if (target.matches('.content')) {\n        handleDoubleClick(target);\n    }\n});\n\nfunction handleDoubleClick(element) {\n    navigator.clipboard.writeText(element.innerText);\n}\n\n\nfunction renderTitleHtml(content, css) {\n    if (!content) return '';\n    return `<span class=\"htitle ${css}\" style=\"margin: 0 4px 0 0;\">${content}</span>`;\n}\n\nfunction renderTipHtml(content, css) {\n    if (!content) return '';\n    return `<div class=\"tips\"><span class=\"${css}\" style=\"margin-bottom: 20px;\">${escapeHtml(content)}</span></div>`;\n}\n\n// 转义 C0 Controls and Basic Latin 中非数字和字母，C1 Controls and Latin-1 Supplement 全部\n// https://www.w3schools.com/charsets/ref_html_utf8.asp\nfunction escapeHtml(unsafe) {\n    return unsafe?.replace(\n        /[\\u0000-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u00FF]/g,\n        c => '&#' + ('000' + c.charCodeAt(0)).slice(-4) + ';'\n    )\n}\n"]}