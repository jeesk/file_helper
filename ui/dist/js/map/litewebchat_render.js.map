{"version":3,"sources":["render.js"],"names":["TipsType","tipsNormal","tipsPrimary","tipsSuccess","tipsInfo","tipsWarning","tipsDanger","TitleType","admin","owner","beforeRenderingHTML","data","chatboxClass","length","htmlStr","chatBox","document","querySelector","i","isRender","messageType","indexOf","renderTipHtml","html","renderMessageHtml","insertAdjacentHTML","setTimeout","scrollHeight","clientHeight","scrollTop","console","log","localStorage","setItem","JSON","stringify","concat","position","diamond","headIcon","renderTitleHtml","htitle","htitleType","escapeHtml","name","content","css","unsafe","replace","c","charCodeAt","slice"],"mappings":"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","file":"../litewebchat_render.js","sourcesContent":["const TipsType = {\n    tipsNormal: 'tips',\n    tipsPrimary: 'tips-primary',\n    tipsSuccess: 'tips-success',\n    tipsInfo: 'tips-info',\n    tipsWarning: 'tips-warning',\n    tipsDanger: 'tips-danger',\n};\nconst TitleType = {\n    admin: 'admin',\n    owner: 'owner',\n};\n\nfunction beforeRenderingHTML(data, chatboxClass) {\n    if(data.length == 0){\n        return\n    }\n    let htmlStr = '';\n    let chatBox = document.querySelector(chatboxClass);\n    for (let i = 0; i < data.length; i++) {\n        if (data[i].isRender) {\n            continue;\n        }\n        if (data[i].messageType.indexOf('tips') !== -1) {\n            htmlStr += renderTipHtml(data[i].html, TipsType[data[i].messageType] || 'tips');\n        } else {\n            htmlStr += renderMessageHtml(data[i]);\n        }\n        data[i].isRender = true;\n    }\n\n    chatBox.insertAdjacentHTML('beforeend', htmlStr);\n    setTimeout(() => {\n        if (chatBox.scrollHeight > chatBox.clientHeight) {\n            chatBox.scrollTop = chatBox.scrollHeight;\n            chatBox = '';\n            htmlStr = '';\n        }\n    }, 300);\n    console.log(\"你好\");\n    localStorage.setItem(\"htmls\", JSON.stringify(data))\n}\n\nfunction renderMessageHtml(data) {\n    return `<div class=\"c${data.position} cmsg\">\n        <img class=\"headIcon ${data.diamond ? '' : 'radius'}\" src=\"${data.headIcon}\" ondragstart=\"return false;\" oncontextmenu=\"return false;\"/>\n        <span class=\"name\">\n            ${renderTitleHtml(data.htitle, TitleType[data.htitleType] || '')}\n            <span>${escapeHtml(data.name) || '&nbsp;'}</span>\n        </span>\n        <span class=\"content\">${data.messageType === 'raw' ? data.html : escapeHtml(data.html)}</span>\n    </div>`;\n}\n\nfunction renderTitleHtml(content, css) {\n    if (!content) return '';\n    return `<span class=\"htitle ${css}\" style=\"margin: 0 4px 0 0;\">${content}</span>`;\n}\n\nfunction renderTipHtml(content, css) {\n    if (!content) return '';\n    return `<div class=\"tips\"><span class=\"${css}\" style=\"margin-bottom: 20px;\">${escapeHtml(content)}</span></div>`;\n}\n\n// 转义 C0 Controls and Basic Latin 中非数字和字母，C1 Controls and Latin-1 Supplement 全部\n// https://www.w3schools.com/charsets/ref_html_utf8.asp\nfunction escapeHtml(unsafe) {\n    return unsafe?.replace(\n        /[\\u0000-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u00FF]/g,\n        c => '&#' + ('000' + c.charCodeAt(0)).slice(-4) + ';'\n    )\n}\n"]}